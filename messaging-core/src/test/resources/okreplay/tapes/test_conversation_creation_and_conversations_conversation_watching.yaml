!tape
name: test conversation creation and conversations & conversation watching
interactions:
- recorded: 2022-06-22T13:19:15.215Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: 744adad22c02be1f9ffda793398960bedfc491596d57f0fb89a073eb23f6887c
      X-APOLLO-OPERATION-NAME: Conversations
    body: '{"operationName":"Conversations","variables":{"pageInfo":{}},"query":"query Conversations($pageInfo: OpaqueCursorPage!) { conversations(page: $pageInfo) { conversations { __typename ...ConversationFragment } hasMore nextCursor } }  fragment EphemeralUrlFragment
      on EphemeralUrl { expiresAt url }  fragment ProviderFragment on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation { id provider { __typename ...ProviderFragment
      } typingAt seenUntil }  fragment ConversationFragment on Conversation { id title subtitle createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 22 Jun 2022 13:19:15 GMT
      connection: close
      content-length: '391'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: cce64fc8-4c7a-4b9e-9417-ab2746c87328
    body: '{"data":{"conversations":{"conversations":[{"__typename":"Conversation","id":"e0f15308-751b-426b-8930-858831bf420b","title":"Test custom title","subtitle":null,"createdAt":"2022-06-22T15:19:13.675+02:00","updatedAt":"2022-06-22T15:19:13.675+02:00","inboxPreviewTitle":"Test
      custom title","lastMessagePreview":null,"unreadMessageCount":0,"providers":[]}],"hasMore":false,"nextCursor":"100"}}}'
- recorded: 2022-06-22T13:19:15.337Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: d0766bc56bfc5d51f74b24b8fb6fd0f2cad0a6c915bb2a2980c8a327d80bf04d
      X-APOLLO-OPERATION-NAME: CreateConversation
    body: '{"operationName":"CreateConversation","variables":{},"query":"mutation CreateConversation($title: String, $providerIdToAssign: UUID) { createConversation(title: $title, providerIdToAssign: $providerIdToAssign) { conversation { __typename ...ConversationFragment
      } } }  fragment EphemeralUrlFragment on EphemeralUrl { expiresAt url }  fragment ProviderFragment on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation
      { id provider { __typename ...ProviderFragment } typingAt seenUntil }  fragment ConversationFragment on Conversation { id title subtitle createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment
      } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 22 Jun 2022 13:19:15 GMT
      connection: close
      content-length: '347'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: c0cac283-0616-46ec-b99e-4e864ed26735
    body: '{"data":{"createConversation":{"conversation":{"__typename":"Conversation","id":"81370362-a067-4ce8-9989-1fbab0379e11","title":null,"subtitle":null,"createdAt":"2022-06-22T15:19:15.312+02:00","updatedAt":"2022-06-22T15:19:15.312+02:00","inboxPreviewTitle":"Nouvelle
      conversation","lastMessagePreview":null,"unreadMessageCount":0,"providers":[]}}}}'
