!tape
name: test conversation creation and conversations & conversation watching
interactions:
- recorded: 2022-05-25T16:05:29.548Z
  request:
    method: GET
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      Connection: Upgrade
      Sec-WebSocket-Extensions: permessage-deflate
      Sec-WebSocket-Key: h1vL3WtT5LCzy5P81c5ndQ==
      Sec-WebSocket-Protocol: graphql-ws
      Sec-WebSocket-Version: '13'
      Upgrade: websocket
  response:
    status: 101
    headers:
      connection: Upgrade
      sec-websocket-accept: jEN6KwszOjym6g5s+92R3Q0eFos=
      sec-websocket-protocol: graphql-ws
      upgrade: websocket
      vary: Origin
      x-request-id: 6e6da67e-45fd-402b-a8ea-edfaefc4801a
    body: ''
- recorded: 2022-05-25T16:07:05.114Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: 22fb19ccce48c2773255053ad3b5e94d3685a158ca3d6d21a549b4052fcadce6
      X-APOLLO-OPERATION-NAME: Conversations
    body: '{"operationName":"Conversations","variables":{"pageInfo":{}},"query":"query Conversations($pageInfo: OpaqueCursorPage!) { conversations(page: $pageInfo) { conversations { __typename ...ConversationFragment } hasMore nextCursor } }  fragment EphemeralUrlFragment
      on EphemeralUrl { expiresAt url }  fragment ProviderFragment on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation { id provider { __typename ...ProviderFragment
      } typingAt seenUntil }  fragment ConversationFragment on Conversation { id title description createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 25 May 2022 16:07:05 GMT
      connection: close
      content-length: '81'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: 12e7b424-0c0a-45ae-99c2-f56dcf4fa459
    body: '{"data":{"conversations":{"conversations":[],"hasMore":false,"nextCursor":null}}}'
- recorded: 2022-05-25T16:07:05.201Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: 7d1447f32538f697270eb23c4a1230e709ef0ba187cf8f93be9e83de84f335de
      X-APOLLO-OPERATION-NAME: CreateConversation
    body: '{"operationName":"CreateConversation","variables":{},"query":"mutation CreateConversation { createConversation { conversation { __typename ...ConversationFragment } } }  fragment EphemeralUrlFragment on EphemeralUrl { expiresAt url }  fragment ProviderFragment
      on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation { id provider { __typename ...ProviderFragment } typingAt seenUntil }  fragment ConversationFragment
      on Conversation { id title description createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 25 May 2022 16:07:05 GMT
      connection: close
      content-length: '350'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: b18517f0-36f7-44e9-9f56-75082a5eab5e
    body: '{"data":{"createConversation":{"conversation":{"__typename":"Conversation","id":"ba429b9c-2961-45a2-a9c0-40b39b0494df","title":null,"description":null,"createdAt":"2022-05-25T18:07:05.192+02:00","updatedAt":"2022-05-25T18:07:05.192+02:00","inboxPreviewTitle":"Nouvelle
      conversation","lastMessagePreview":null,"unreadMessageCount":0,"providers":[]}}}}'
