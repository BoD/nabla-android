!tape
name: test marking a conversation as read updates the conversation
interactions:
- recorded: 2022-06-22T13:19:20.504Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: d0766bc56bfc5d51f74b24b8fb6fd0f2cad0a6c915bb2a2980c8a327d80bf04d
      X-APOLLO-OPERATION-NAME: CreateConversation
    body: '{"operationName":"CreateConversation","variables":{},"query":"mutation CreateConversation($title: String, $providerIdToAssign: UUID) { createConversation(title: $title, providerIdToAssign: $providerIdToAssign) { conversation { __typename ...ConversationFragment
      } } }  fragment EphemeralUrlFragment on EphemeralUrl { expiresAt url }  fragment ProviderFragment on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation
      { id provider { __typename ...ProviderFragment } typingAt seenUntil }  fragment ConversationFragment on Conversation { id title subtitle createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment
      } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 22 Jun 2022 13:19:20 GMT
      connection: close
      content-length: '347'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: 984e67e6-c3b5-41e7-99f6-0c25dca5a45d
    body: '{"data":{"createConversation":{"conversation":{"__typename":"Conversation","id":"194da0cc-d1cb-461e-a121-a9ca0c1323cf","title":null,"subtitle":null,"createdAt":"2022-06-22T15:19:20.479+02:00","updatedAt":"2022-06-22T15:19:20.479+02:00","inboxPreviewTitle":"Nouvelle
      conversation","lastMessagePreview":null,"unreadMessageCount":0,"providers":[]}}}}'
- recorded: 2022-06-22T13:19:20.574Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: 8039d8277285df2b2a85ccc5e77068982c48539d9d9e1ac36829cd835d0e2c1a
      X-APOLLO-OPERATION-NAME: Conversation
    body: '{"operationName":"Conversation","variables":{"id":"194da0cc-d1cb-461e-a121-a9ca0c1323cf"},"query":"query Conversation($id: UUID!) { conversation(id: $id) { conversation { __typename ...ConversationFragment } } }  fragment EphemeralUrlFragment on EphemeralUrl
      { expiresAt url }  fragment ProviderFragment on Provider { id avatarUrl { __typename ...EphemeralUrlFragment } prefix firstName lastName }  fragment ProviderInConversationFragment on ProviderInConversation { id provider { __typename ...ProviderFragment
      } typingAt seenUntil }  fragment ConversationFragment on Conversation { id title subtitle createdAt updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount providers { __typename ...ProviderInConversationFragment } }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 22 Jun 2022 13:19:20 GMT
      connection: close
      content-length: '341'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: b97a7638-37d1-40d3-a4be-f785fbdfe42b
    body: '{"data":{"conversation":{"conversation":{"__typename":"Conversation","id":"194da0cc-d1cb-461e-a121-a9ca0c1323cf","title":null,"subtitle":null,"createdAt":"2022-06-22T15:19:20.479+02:00","updatedAt":"2022-06-22T15:19:20.479+02:00","inboxPreviewTitle":"Nouvelle
      conversation","lastMessagePreview":null,"unreadMessageCount":0,"providers":[]}}}}'
- recorded: 2022-06-22T13:19:20.679Z
  request:
    method: POST
    uri: http://localhost:3000/api/v1/patient/graphql/sdk/authenticated
    headers:
      X-APOLLO-OPERATION-ID: a973f2284d59f60249232b808891cce2aa76e2403dc8c88ec37aecfe6afb9e20
      X-APOLLO-OPERATION-NAME: MaskAsSeen
    body: '{"operationName":"MaskAsSeen","variables":{"conversationId":"194da0cc-d1cb-461e-a121-a9ca0c1323cf"},"query":"mutation MaskAsSeen($conversationId: UUID!) { markAsSeen(conversationId: $conversationId) { __typename conversation { __typename ...ConversationPreviewFragment
      } } }  fragment ConversationPreviewFragment on Conversation { id updatedAt inboxPreviewTitle lastMessagePreview unreadMessageCount }"}'
  response:
    status: 200
    headers:
      Access-Control-Allow-Origin: '*'
      Date: Wed, 22 Jun 2022 13:19:20 GMT
      connection: close
      content-length: '295'
      content-type: application/json; charset=UTF-8
      vary: Origin
      x-nabla-minimum-android-code-version: '0'
      x-nabla-minimum-code-version: '323'
      x-nabla-minimum-ios-code-version: '0'
      x-request-id: 3031cf54-3d3f-4f04-a839-5e64d137ce37
    body: '{"data":{"markAsSeen":{"__typename":"MarkConversationAsSeenOutput","conversation":{"__typename":"Conversation","id":"194da0cc-d1cb-461e-a121-a9ca0c1323cf","updatedAt":"2022-06-22T15:19:20.479+02:00","inboxPreviewTitle":"Nouvelle conversation","lastMessagePreview":null,"unreadMessageCount":0}}}}'
